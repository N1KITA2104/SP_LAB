### Крок 1: Розбивка на базові блоки
Для спрощення ми розглянемо базові блоки:
- e1 = kk
- e2 = kg
- e3 = g
- e4 = gk

### Крок 2: Побудова НСА для базових блоків
- Для e1 = kk:
  - Стартуємо в стані \( q0 \), переходимо до \( q1 \) через \( k \), потім до \( q2 \) через ще одне \( k \).

- Для e2 = kg:
  - Стартуємо в стані \( q3 \), переходимо до \( q4 \) через \( k \), потім до \( q5 \) через \( g \).

- Для e3 = g:
  - Однокроковий перехід від \( q6 \) до \( q7 \) через \( g \).

- Для e4 = gk:
  - Стартуємо в стані \( q8 \), переходимо до \( q9 \) через \( g \), потім до \( q{10} \) через \( k \).

### Крок 3: Комбінування компонентів для побудови загального НСА
- Для (kg)+g:
  - Об'єднуємо \( e2 \) з \( e3 \), використовуючи стан \( q5 \) як проміжний перед \( q6 \).

- Для ((kg)+g)*:
  - Додати єпсілон-перехід з \( q7 \) назад до \( q3 \) та єпсілон-перехід до кінцевого стану, що вказує на здатність повторювати цикл або завершувати.

- Для g(gk)*:
  - Від \( q7 \) до \( q8 \) через \( g \), з єпсілон-переходами з \( q{10} \) назад до \( q8 \) або до кінцевого стану.

### Крок 4: Загальна структура автомату
- Початковий стан є \( q0 \), з єпсілон-переходом до \( q1 \) (початок для \( kk \)) і до \( q3 \) (початок для \( (kg)+g \)).
- \( (kg)+g \) обробляється з циклами між \( q3 \) і \( q7 \).
- Перехід від \( q7 \) до \( q8 \) та цикли між \( q8 \) і \( q{10} \) для обробки \( g(gk)* \).
- Кінцеві стани можуть бути \( q2 \), \( q7 \), \( q{10} \), залежно від того, як завершується ввід.


| Стан  | 'k'    | 'g'    | ɛ-transition                  |
|-------|--------|--------|-------------------------------|
| q0    |        |        | q1, q3                        |
| q1    | q2     |        |                               |
| q2    |        |        |                               |
| q3    | q4     |        |                               |
| q4    |        | q5     |                               |
| q5    |        |        | q3, q6                        |
| q6    |        | q7     |                               |
| q7    |        |        | q8, final state (repeat zone) |
| q8    |        | q9     |                               |
| q9    |        |        | q10                           |
| q10   |        |        | q8, final state               |
